<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fuzzifino ¬∑ FuzzifiED.jl</title><meta name="title" content="Fuzzifino ¬∑ FuzzifiED.jl"/><meta property="og:title" content="Fuzzifino ¬∑ FuzzifiED.jl"/><meta property="twitter:title" content="Fuzzifino ¬∑ FuzzifiED.jl"/><meta name="description" content="Documentation for FuzzifiED.jl."/><meta property="og:description" content="Documentation for FuzzifiED.jl."/><meta property="twitter:description" content="Documentation for FuzzifiED.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/serif.css" rel="stylesheet" type="text/css"/><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FuzzifiED.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FuzzifiED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../core/">Core Functions</a></li><li><a class="tocitem" href="../models/">Built-in Models</a></li><li><a class="tocitem" href="../itensors/">ITensor Extension</a></li><li><a class="tocitem" href="../extension/">Other Extensions</a></li><li class="is-active"><a class="tocitem" href>Fuzzifino</a><ul class="internal"><li><a class="tocitem" href="#Core-Functions"><span>Core Functions</span></a></li><li><a class="tocitem" href="#Models"><span>Models</span></a></li><li><a class="tocitem" href="#Related-Examples"><span>Related Examples</span></a></li></ul></li><li><a class="tocitem" href="../manifolds/">Fuzzy Manifolds</a></li><li><a class="tocitem" href="../releases/">Releases</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Fuzzifino</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fuzzifino</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FuzzifiED/FuzzifiED.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/main/docs/src/fuzzifino.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fuzzifino"><a class="docs-heading-anchor" href="#Fuzzifino">Fuzzifino</a><a id="Fuzzifino-1"></a><a class="docs-heading-anchor-permalink" href="#Fuzzifino" title="Permalink"></a></h1><p>Fuzzifino is a module for exact diagonalisation (ED) calculation on the fuzzy sphere for systems with both bosons and fermions. The usage is similar to FuzzifiED, with new types <code>SQNDiag</code>, <code>SQNOffd</code>, <code>SConf</code>, <code>SBasis</code>, <code>STerm</code> and <code>SOperator</code> defined. To use the module, include also at the start of your Julia script</p><pre><code class="language-julia hljs">using FuzzifiED.Fuzzifino</code></pre><h2 id="Core-Functions"><a class="docs-heading-anchor" href="#Core-Functions">Core Functions</a><a id="Core-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Functions" title="Permalink"></a></h2><h3 id="Environment-Parameter"><a class="docs-heading-anchor" href="#Environment-Parameter">Environment Parameter</a><a id="Environment-Parameter-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-Parameter" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.Libpathino" href="#FuzzifiED.Fuzzifino.Libpathino"><code>FuzzifiED.Fuzzifino.Libpathino</code></a> ‚Äî <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Fuzzifino.Libpathino :: String = FuzzifiED_jll.LibpathFuzzifino</code></pre><p>define path of the Fortran library <code>libfuzzifino.so</code>. You do not need to modify that by yourself. However, if you compile the Fortran codes by yourself, you need to point this to your compiled library. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/fuzzifino.jl#L13-L17">source</a></section></article><h3 id="Quantum-Numbers"><a class="docs-heading-anchor" href="#Quantum-Numbers">Quantum Numbers</a><a id="Quantum-Numbers-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Numbers" title="Permalink"></a></h3><p>The diagonal and off-diagonal quantum numbers are implemented as</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SQNDiag" href="#FuzzifiED.Fuzzifino.SQNDiag"><code>FuzzifiED.Fuzzifino.SQNDiag</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SQNDiag</code></pre><p>The mutable type <code>SQNDiag</code> records the information of a diagonal <span>$\mathrm{U}(1)$</span> or <span>$‚Ñ§_p$</span> quantum number in the form of a symmetry charge</p><p class="math-container">\[Q=‚àë_{o=1}^{N_{of}}q_{f,o}n_{f,o}+‚àë_{o=1}^{N_{ob}}q_{b,o}n_{b,o}\]</p><p>or</p><p class="math-container">\[Q=‚àë_{o=1}^{N_{of}}q_{f,o}n_{f,o}+‚àë_{o=1}^{N_{ob}}q_{b,o}n_{b,o}\ \mathrm{mod}\ p\]</p><p>where <span>$i=1,‚Ä¶,N_U$</span> is the index of quantum number, <span>$o$</span> is the index of site, <span>$N_{of}$</span> and <span>$N_{ob}$</span> are the number of fermionic and bosonic sites, <span>$n_{f,o}=f^‚Ä†_of_o$</span>, <span>$n_{b,o}=b^‚Ä†_ob_o$</span>, and <span>$q_{f,o},q_{b,o}$</span> are a set of symmetry charges that must be integer valued.</p><p><strong>Fields</strong></p><ul><li><code>name :: String</code> is the name of the diagonal quantum number </li><li><code>chargef :: Vector{Int64}</code> is the symmetry charge <span>$q_{f,o}$</span> of each site</li><li><code>chargeb :: Vector{Int64}</code> is the symmetry charge <span>$q_{b,o}$</span> of each site</li><li><code>modul :: Vector{Int64}</code> is the modulus <span>$p$</span>, set to 1 for <span>$\mathrm{U}(1)$</span> SQNDiags. </li></ul><p><strong>Initialisation</strong></p><p>It can be initialised by the following method</p><pre><code class="language-julia hljs">SQNDiag([name :: String, ]chargef :: Vector{Int64}, chargeb :: Vector{Int64}[, modul :: Int64]) :: SQNDiag</code></pre><p>The arguments <code>name</code> and <code>modul</code> are facultative. By default <code>name</code> is set to <code>&quot;QN&quot;</code> and <code>modul</code> is set to 1. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L5-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SQNOffd" href="#FuzzifiED.Fuzzifino.SQNOffd"><code>FuzzifiED.Fuzzifino.SQNOffd</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SQNOffd</code></pre><p>The mutable type <code>SQNOffd</code> records the information of an off-diagonal <span>$‚Ñ§_p$</span> quantum number in the form of a discrete transformation</p><p class="math-container">\[ùíµ:\ f_o‚Ü¶ Œ±_{f,o}^* f^{(p_{f,o})}_{œÄ_{f,o}},‚ÄÉ f_o^‚Ä†‚Ü¶Œ±_{f,o} c^{(1-p_{f,o})}_{œÄ_{f,o}},‚ÄÉ b_o^‚Ä†‚Ü¶Œ±_{b,o} b^‚Ä†_{œÄ_{b,o}}\]</p><p>where we use a notation <span>$c^{(1)}=c^‚Ä†$</span> and <span>$c^{0}=c$</span> for convenience, <span>$œÄ_{f,o},œÄ_{b,o}$</span> are permutations of <span>$1,‚Ä¶,N_{of}$</span> or <span>$N_{ob}$</span>, <span>$Œ±_{f,o},Œ±_{b,o}$</span> are coefficients, and <span>$p_{f,o}$</span> specified whether or not particle-hole transformation is performed for the fermionic site. Note that one must guarentee that all these transformations commute with each other and also commute with the diagonal QNs. </p><p><strong>Arguments</strong></p><ul><li><code>permf :: Vector{Int64}</code> is a length-<span>$N_{of}$</span> vector that records the fermion permutation <span>$œÄ_{f,o}$</span>.</li><li><code>permb :: Vector{Int64}</code> is a length-<span>$N_{ob}$</span> vector that records the boson permutation <span>$œÄ_{b,o}$</span>.</li><li><code>phf :: Vector{Int64}</code> is a length-<span>$N_{of}$</span> vector that records <span>$p_{f,o}$</span> to determine whether or not to perform a particle-hole transformation</li><li><code>facf :: Vector{ComplexF64}</code> is a length-<span>$N_{of}$</span> vector that records the factor <span>$Œ±_{f,o}$</span> in the transformation.</li><li><code>facb :: Vector{ComplexF64}</code> is a length-<span>$N_{ob}$</span> vector that records the factor <span>$Œ±_{b,o}$</span> in the transformation.</li><li><code>cyc :: Int64</code> is the cycle <span>$p$</span>. </li></ul><p><strong>Initialisation</strong></p><p>It can be initialised by the following method</p><pre><code class="language-julia hljs">SQNOffd(permf :: Vector{Int64}, permb :: Vector{Int64}[, phf :: Vector{Int64}][, facf :: Vector{ComplexF64}, facb :: Vector{ComplexF64}][, cyc :: Int64]) :: SQNOffd
SQNOffd(permf :: Vector{Int64}, permb :: Vector{Int64}, phf_q :: Bool[, fac :: Vector{ComplexF64}, facb :: Vector{ComplexF64}]) :: SQNOffd</code></pre><p>The arguments <code>phf</code>, <code>facf</code>, <code>facb</code> and <code>cyc</code> are facultative. By default <code>ph</code> is set all 0, <code>facf</code>, <code>facb</code> is set to all 1 and <code>cyc</code> is set to 2. If <code>phf_q</code> is a bool and true, then <code>ph</code> is set to all 1. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L116-L143">source</a></section></article><p>The SQNs can be converted from the fermionic QNs by setting the bosonic part to identity. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SQNDiag-Tuple{QNDiag, Int64}" href="#FuzzifiED.Fuzzifino.SQNDiag-Tuple{QNDiag, Int64}"><code>FuzzifiED.Fuzzifino.SQNDiag</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SQNDiag(qnd :: QNDiag, nob :: Int64) :: SQNDiag</code></pre><p>converts a pure fermionic QNDiag to a SQNDiag with the boson charges set to empty, implemented as </p><pre><code class="language-julia hljs">SQNDiag(qnd.name, qnd.charge, fill(0, nob), qnd.modul)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SQNOffd-Tuple{QNOffd, Int64}" href="#FuzzifiED.Fuzzifino.SQNOffd-Tuple{QNOffd, Int64}"><code>FuzzifiED.Fuzzifino.SQNOffd</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SQNOffd(qnf :: QNOffd, nob :: Int64) :: SQNOffd</code></pre><p>converts a pure fermionic QNOffd to a SQNOffd with the boson transformations set to identity, implemented as </p><pre><code class="language-julia hljs">SQNOffd(qnf.perm, collect(1 : nob), qnf.ph, qnf.fac, fill(ComplexF64(1), nob), qnf.cyc)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L158-L164">source</a></section></article><p>Several operations of the SQNs are supported.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Int64, SQNDiag}" href="#Base.:*-Tuple{Int64, SQNDiag}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(fac :: Int64, qnd :: SQNDiag) :: SQNDiag 
*(qnd :: SQNDiag, fac :: Int64) :: SQNDiag 
√∑(qnd :: SQNDiag, fac :: Int64) :: SQNDiag 
-(qnd :: SQNDiag) :: SQNDiag</code></pre><p>returns the SQNDiag multiplied or divided by an integer factor, where the charge is multiplied or integer-divided by the factor. For <span>$‚Ñ§_p$</span> quantum numbers, their modulus will be multiplied or integer-divided by the absolute value. If <code>qnd.modul √∑ abs(fac) ‚â§ 1</code>, a trivial SQNDiag will be returned.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L53-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{SQNDiag, SQNDiag}" href="#Base.:+-Tuple{SQNDiag, SQNDiag}"><code>Base.:+</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">+(qnd1 :: SQNDiag, qnd2 :: SQNDiag) :: SQNDiag 
-(qnd1 :: SQNDiag, qnd2 :: SQNDiag) :: SQNDiag</code></pre><p>returns the sum or substraction of two SQNDiags, whose name is the samea as <code>qnd1</code>, charge is the same as <code>qnd1 ¬± qnd2</code>, and modulus is the GCD of <code>qnd1</code> and <code>qnd2</code>. If <code>qnd1</code> and <code>qnd2</code> are both <span>$‚Ñ§_p$</span> quantum numbers and their modulus are coprime, a trivial SQNDiag will be returned. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L78-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{SQNOffd, SQNOffd}" href="#Base.:*-Tuple{SQNOffd, SQNOffd}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(qnf1 :: SQNOffd, qnf2 :: SQNOffd) :: SQNOffd</code></pre><p>returns the composition of two SQNOffd transformations. The cycle is set to be the LCM of two QNOffds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L168-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.PadSQNDiag" href="#FuzzifiED.Fuzzifino.PadSQNDiag"><code>FuzzifiED.Fuzzifino.PadSQNDiag</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PadSQNDiag(qnd :: SQNDiag, nofl :: Int64, nobl :: Int64, nofr :: Int64, nobr :: Int64)</code></pre><p>adds <code>nol</code> empty orbitals to the left and <code>nor</code> empty orbitals to the right, implemented as </p><pre><code class="language-julia hljs">SQNDiag(qnd.name, 
    [ fill(0, nofl) ; qnd.chargef ; fill(0, nofr) ], 
    [ fill(0, nobl) ; qnd.chargeb ; fill(0, nobr) ], 
    qnd.modul)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L100-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.PadSQNOffd" href="#FuzzifiED.Fuzzifino.PadSQNOffd"><code>FuzzifiED.Fuzzifino.PadSQNOffd</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PadSQNOffd(qnf :: SQNOffd, nofl :: Int64, nobl :: Int64, nofr :: Int64, nobr :: Int64)</code></pre><p>adds <code>nofl</code> fermionic and <code>nobl</code> bosonic empty orbitals to the left and <code>nofr</code> fermionic and <code>nobr</code> bosonic empty orbitals to the right, implemented as </p><pre><code class="language-julia hljs">SQNOffd(
    [ collect(1 : nofl) ; qnf.permf .+ nofl ; collect(1 : nofr) .+ (nofl + length(qnf.permf)) ], 
    [ collect(1 : nobl) ; qnf.permb .+ nobl ; collect(1 : nobr) .+ (nobl + length(qnf.permb)) ], 
    [ fill(0, nofl) ; qnf.phf ; fill(0, nofr) ], 
    [ fill(ComplexF64(1), nofl) ; qnf.facf ; fill(ComplexF64(1), nofr) ], 
    [ fill(ComplexF64(1), nobl) ; qnf.facb ; fill(ComplexF64(1), nobr) ], 
    qnf.cyc)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sqn.jl#L184-L196">source</a></section></article><h3 id="Configurations"><a class="docs-heading-anchor" href="#Configurations">Configurations</a><a id="Configurations-1"></a><a class="docs-heading-anchor-permalink" href="#Configurations" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SConfs" href="#FuzzifiED.Fuzzifino.SConfs"><code>FuzzifiED.Fuzzifino.SConfs</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SConfs</code></pre><p>The mutable type <code>SConfs</code> stores all the configurations that respects the diagonal quantum numbers (SQNDiag) and also a table to inversely look up the index from the configuration. </p><p><strong>Fields</strong></p><ul><li><code>nof :: Int64</code> is the number of fermionic sites.</li><li><code>nof :: Int64</code> is the number of bosonic sites.</li><li><code>nebm :: Int64</code> is the maximal number of boson occupation.</li><li><code>ncf :: Int64</code> is the number of configurations.</li><li><code>conff :: Vector{Int64}</code> is an array of length <code>ncf</code> containing all the fermion configurations. Each configuration is expressed in a binary number. If the <code>o-1</code>-th bit of <code>conf[i]</code> is 1, then the <code>o</code>-th site in the <code>i</code>-th configuration is occupied ; if the bit is 0, then the site is empty. </li><li><code>confb :: Vector{Int64}</code> is an array of length <code>ncf</code> containing all the boson configurations. Each configuration is expressed in a binary number that has <span>$N_{b,o}$</span> 1&#39;s and <span>$N_{eb}$</span> 0&#39;s and the number of 0&#39;s following each 1 records the number of bosons in that site. </li><li><code>norf :: Int64</code>, <code>nobf :: Int64</code>, <code>lid :: Vector{Int64}</code> and <code>rid :: Vector{Int64}</code> contain the information of Lin table that is used to inversely look up the index <code>i</code> from the configuration. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sconfs.jl#L4-L18">source</a></section></article><p>It can be generated from the QNDiags.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SConfs-Tuple{Int64, Int64, Int64, Vector{Int64}, Vector{SQNDiag}}" href="#FuzzifiED.Fuzzifino.SConfs-Tuple{Int64, Int64, Int64, Vector{Int64}, Vector{SQNDiag}}"><code>FuzzifiED.Fuzzifino.SConfs</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SConfs(nof :: Int64, nob :: Int64, nebm :: Int64, secd :: Vector{Int64}, qnd :: Vector{SQNDiag} ; , num_th :: Int64, disp_std :: Bool) :: Confs</code></pre><p>generates the configurations from the list of QNDiags. </p><p><strong>Arguments</strong></p><ul><li><code>nof :: Int64</code> is the number of fermionic sites <span>$N_{of}$</span>.</li><li><code>nob :: Int64</code> is the number of bosonic sites <span>$N_{ob}$</span>.</li><li><code>nebm :: Int64</code> is the maximal number of total bosons.</li><li><code>secd :: Vector{Int64}</code> is the set of <span>$Q_i$</span> for the selected configurations in the sector.</li><li><code>qnd :: Vector{SQNDiag}</code> is the set of <a href="#FuzzifiED.Fuzzifino.SQNDiag">SQNDiags</a>.</li><li><code>norf :: Int64</code> and <code>norb :: Int64</code> are the number of less significant bits used to generate the Lin table. Facultative, <span>$N_{of}/2$</span> and <span>$N_{ob}/2$</span> by default.</li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default.</li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul><p><strong>Output</strong></p><ul><li><code>cfs :: SConfs</code> is a <a href="#FuzzifiED.Fuzzifino.SConfs">SConfs</a> object.</li></ul><p><strong>Note</strong></p><p>If your <code>qnd</code> has negative entries, QNDiags must contain the total number of particles (<em>i. e.</em>, bosons plus fermions).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sconfs.jl#L33-L56">source</a></section></article><h3 id="Basis"><a class="docs-heading-anchor" href="#Basis">Basis</a><a id="Basis-1"></a><a class="docs-heading-anchor-permalink" href="#Basis" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SBasis" href="#FuzzifiED.Fuzzifino.SBasis"><code>FuzzifiED.Fuzzifino.SBasis</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SBasis</code></pre><p>The mutable type <code>SBasis</code> stores the information of the SBasis that respects both diagonal and off-diagonal quantum numbers. The states in the SBasis is in the form </p><p class="math-container">\[|I‚ü©=Œª_{i_{I1}}|i_{I1}‚ü©+Œª_{i_{I2}}|i_{I2}‚ü©+‚ãØ+Œª_{i_{Im_I}}|i_{Im_I}‚ü©\]</p><p>where <span>$|i‚ü©$</span> is a direct product state, <em>i. e.</em>, the configurations <span>$|i_{Ik}‚ü©$</span> are grouped into a state <span>$|I‚ü©$</span>. </p><p><strong>Fields</strong></p><ul><li><code>cfs :: SConfs</code> stores the configurations that respect the QNDiags.</li><li><code>dim :: Int64</code> is the dimension of the SBasis.</li><li><code>szz :: Int64</code> records the maximum size <span>$\max m_g$</span> of groups.</li><li><code>cfgr :: Vector{Int64}</code> is a vector of length <code>cfs.ncf</code> and records which group <span>$|I‚ü©$</span> each configuration <span>$|i‚ü©$</span> belong to.</li><li><code>cffac :: Vector{ComplexF64}</code> is a vector of length <code>cfs.ncf</code> and records the coefficients <span>$Œª_i$</span> of each configuration.</li><li><code>grel :: Matrix{Int64}</code> is a <code>szz</code>√ó<code>dim</code> matrix that records the configurations in each group <span>$|i_{Ik}‚ü© (k = 1,‚Ä¶,m_I)$</span></li><li><code>grsz :: Vector{Int64}</code> is a vector of length <code>dim</code> that records the size <span>$m_I$</span> of each group.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sbasis.jl#L4-L21">source</a></section></article><p>It can be generated by the following methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SBasis-Tuple{SConfs, Vector{&lt;:Number}, Vector{SQNOffd}}" href="#FuzzifiED.Fuzzifino.SBasis-Tuple{SConfs, Vector{&lt;:Number}, Vector{SQNOffd}}"><code>FuzzifiED.Fuzzifino.SBasis</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SBasis(cfs :: SConfs, secf :: Vector{ComplexF64}, qnf :: Vector{SQNOffd} ; num_th :: Int64, disp_std :: Bool)</code></pre><p>generates the SBasis that respects the off-diagonal <span>$‚Ñ§_p$</span> quantum numbers (secfQNOffd)</p><p><strong>Arguments</strong></p><ul><li><code>cfs :: SConfs</code> is the diagonal QN‚Äìpreserving configurations.</li><li><code>secf :: Vector{ComplexF64}</code> is a vector of length the same as the number of discrete symmetries that records the eigenvalue of each transformation in the sector.</li><li><code>qnf :: Vector{SQNOffd}</code> is a vector of off-diagonal quantum numbers.</li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default.</li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul><p><strong>Output</strong></p><ul><li><code>bs :: SBasis</code> is the resulting <a href="#FuzzifiED.Fuzzifino.SBasis">SBasis</a> object.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sbasis.jl#L33-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SBasis-Tuple{SConfs}" href="#FuzzifiED.Fuzzifino.SBasis-Tuple{SConfs}"><code>FuzzifiED.Fuzzifino.SBasis</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SBasis(cfs :: SConfs)</code></pre><p>Generate a SBasis from the configurations without off-diagonal <span>$‚Ñ§_n$</span> symmetries.</p><p><strong>Arguments</strong></p><ul><li><code>cfs :: SConfs</code> is the diagonal QN‚Äìpreserving configurations.</li></ul><p><strong>Output</strong></p><ul><li><code>bs :: SBasis</code> is the resulting <code>SBasis</code> object.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sbasis.jl#L84-L96">source</a></section></article><h3 id="Term"><a class="docs-heading-anchor" href="#Term">Term</a><a id="Term-1"></a><a class="docs-heading-anchor-permalink" href="#Term" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.STerm" href="#FuzzifiED.Fuzzifino.STerm"><code>FuzzifiED.Fuzzifino.STerm</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">STerm</code></pre><p>The mutable type <code>STerm</code> records a STerm that looks like <span>$Ua^{(p_1)}_{o_1}a^{(p_2)}_{o_2}‚Ä¶ a^{(p_l)}_{o_l}$</span> in an operator, where positive <span>$o$</span> denotes fermions and negative <span>$o$</span> denotes bosons</p><p class="math-container">\[    a^{(0)}_o=f_o,‚ÄÉa^{(1)}_o=f_o^‚Ä†,‚ÄÉa^{(0)}_{-o}=b_o,‚ÄÉa^{(1)}_{-o}=b_o^‚Ä†\]</p><p><strong>Fields</strong></p><ul><li><code>coeff :: ComplexF64</code> records the coefficient <span>$U$</span></li><li><code>cstr :: Vector{Int64}</code> is a length-<span>$2l$</span> vector <span>$(p_1,o_1,p_2,o_2,‚Ä¶ p_l,o_l)$</span> recording the operator string</li></ul><p><strong>Method</strong></p><p>It can be generated by the function or directly from a term</p><pre><code class="language-julia hljs">STerm(coeff :: ComplexF64, cstr :: Vector{Int64})
STerm(tm :: Term)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L5-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.STerms" href="#FuzzifiED.Fuzzifino.STerms"><code>FuzzifiED.Fuzzifino.STerms</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>STerms</code> is an alias for <code>Vector{STerm}</code> for convenience</p><p><strong>Initialisation</strong></p><pre><code class="language-julia hljs">STerms(coeff :: Number, cstr :: Vector{Int64})</code></pre><p>Gives a <code>STerms</code> with a single <code>STerm</code>.</p><pre><code class="language-julia hljs">STerms(tms :: Terms)</code></pre><p>Generates <code>STerms</code> from <code>Terms</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L31-L46">source</a></section></article><p>The product of terms with a number, the sum and product of terms, adjoint and particle-hole transformation are defined</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Number, Vector{STerm}}" href="#Base.:*-Tuple{Number, Vector{STerm}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(fac :: Number, tms :: STerms) :: STerms
-(tms :: STerms) :: STerms
*(tms :: STerms, fac :: Number) :: STerms
/(tms :: STerms, fac :: Number) :: STerms</code></pre><p>Return the product of a collection of STerms with a number. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L52-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{Vector{STerm}, Vector{STerm}}" href="#Base.:+-Tuple{Vector{STerm}, Vector{STerm}}"><code>Base.:+</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">+(tms1 :: STerms, tms2 :: STerms) :: STerms
-(tms1 :: STerms, tms2 :: STerms) :: STerms</code></pre><p>Return the naive sum of two series of STerms by taking their union. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L74-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Vector{STerm}, Vector{STerm}}" href="#Base.:*-Tuple{Vector{STerm}, Vector{STerm}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(tms1 :: STerms, tms2 :: STerms) :: STerms
^(tms :: STerms, pow :: Int64) :: STerms</code></pre><p>Return the naive product of two series of STerms or the power of one STerms. The number of STerms equals the product of the number of STerms in <code>tms1</code> and <code>tms2</code>. For each STerm in <code>tms1</code> <span>$Ua^{(p_1)}_{o_1}‚Ä¶$</span> and <code>tms2</code> <span>$U&#39;a^{(p&#39;_1)}_{o&#39;_1}‚Ä¶$</span>, a new STerm is formed by taking <span>$UU&#39;a^{(p_1)}_{o_1}‚Ä¶ a^{(p&#39;_1)}_{o&#39;_1}‚Ä¶$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L91-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.adjoint-Tuple{Vector{STerm}}" href="#Base.adjoint-Tuple{Vector{STerm}}"><code>Base.adjoint</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adjoint(tm :: STerm) :: STerm
adjoint(tms :: STerms) :: STerms</code></pre><p>Return the Hermitian conjugate of a series of STerms. For each STerm <span>$Ua^{(p_1)}_{o_1}a^{(p_2)}_{o_2}‚Ä¶ a^{(p_l)}_{o_l}$</span>, the adjoint is <span>$\bar{U}a^{(1-p_l)}_{o_l}‚Ä¶ a^{(1-p_2)}_{o_2}a^{(1-p_1)}_{o_1}$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L117-L122">source</a></section></article><p>The terms can be simplified and manipulated by </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.NormalOrder-Tuple{STerm}" href="#FuzzifiED.NormalOrder-Tuple{STerm}"><code>FuzzifiED.NormalOrder</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NormalOrder(tm :: STerm) :: STerms</code></pre><p>rearrange a STerm such that </p><ul><li>the creation operators must be commuted in front of the annihilation operator </li><li>the site index of the creation operators are in ascending order and the annihilation operators in descending order. </li></ul><p>return a list of STerms whose result is equal to the original STerm. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L128-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.SimplifyTerms-Tuple{Vector{STerm}}" href="#FuzzifiED.SimplifyTerms-Tuple{Vector{STerm}}"><code>FuzzifiED.SimplifyTerms</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimplifyTerms(tms :: STerms ; cutoff :: Float64 = eps(Float64)) :: STerms</code></pre><p>simplifies the sum of STerms such that </p><ul><li>each STerm is normal ordered,</li><li>like STerms are combined, and STerms with zero coefficients are removed.</li></ul><p><strong>Argument</strong></p><ul><li><code>cutoff :: Float64</code> is the cutoff such that STerms with smaller absolute value of coefficients will be neglected. Facultative, <code>eps(Float64)</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L177-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.RemoveOrbs-Tuple{Vector{STerm}, Vector{Int64}}" href="#FuzzifiED.RemoveOrbs-Tuple{Vector{STerm}, Vector{Int64}}"><code>FuzzifiED.RemoveOrbs</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RemoveOrbs(tms :: STerms, o_rm :: Vector{Int64}) :: STerms</code></pre><p>remove all the terms that has creation or annihilation operators of sites in the set <code>o_rm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L216-L220">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.RelabelOrbs-Tuple{Vector{STerm}, Dict{Int64, Int64}}" href="#FuzzifiED.RelabelOrbs-Tuple{Vector{STerm}, Dict{Int64, Int64}}"><code>FuzzifiED.RelabelOrbs</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RelabelOrbs(tms :: STerms, dict_o :: Dict{Int64, Int64})</code></pre><p>Relabel all the orbitals. Terms that has operators on the sites that are not in the keys of <code>dict_o</code> are removed. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L225-L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.PadSTerms" href="#FuzzifiED.Fuzzifino.PadSTerms"><code>FuzzifiED.Fuzzifino.PadSTerms</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PadSTerms(tms :: STerms, nol :: Int64)</code></pre><p>adds <code>nofl</code> fermionic and <code>nobl</code> bosonic empty orbitals to the left by shifting each orbital index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sterm.jl#L259-L263">source</a></section></article><h3 id="Operator"><a class="docs-heading-anchor" href="#Operator">Operator</a><a id="Operator-1"></a><a class="docs-heading-anchor-permalink" href="#Operator" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SOperator" href="#FuzzifiED.Fuzzifino.SOperator"><code>FuzzifiED.Fuzzifino.SOperator</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SOperator</code></pre><p>The mutable type <code>SOperator</code> records the sum of terms together with information about its symmetry and the basis of the state it acts on and the basis of the resulting state.</p><p><strong>Fields</strong></p><ul><li><code>bsd :: SBasis</code> is the basis of the initial state.</li><li><code>bsf :: SBasis</code> is the basis of the final state.</li><li><code>red_q :: Int64</code> is a flag that records whether or not the conversion to a sparse martrix can be simplified : if <code>bsd</code> and <code>bsf</code> have exactly the same set of quantum numbers, and the operator fully respects the symmetries, and all the elements in <code>bsd.cffac</code> and <code>bsf.cffac</code> has the same absolute value, then <code>red_q = 1</code> ; otherwise <code>red_q = 0</code>.</li><li><code>sym_q :: Int64</code> records the symmetry of the operator : if the matrix is Hermitian, then <code>sym_q = 1</code> ; if it is symmetric, then <code>sym_q = 2</code> ; otherwise <code>sym_q = 0</code>.</li><li><code>ntm :: Int64</code> is the number of terms.</li><li><code>nc :: Int64</code> is the maximum number of operators in an operator string</li><li><code>cstrs :: Matrix{Int64}</code> is a matrix recording the operator string of each term. Each column corresponds to a term and is padded to the maximum length with <code>-1</code>&#39;s.</li><li><code>coeffs :: Vector{ComplexF64}</code> corresponds to the coefficients in each term.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/soperator.jl#L4-L18">source</a></section></article><p>It can be generated by the following methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SOperator-Tuple{SBasis, SBasis, Vector{STerm}}" href="#FuzzifiED.Fuzzifino.SOperator-Tuple{SBasis, SBasis, Vector{STerm}}"><code>FuzzifiED.Fuzzifino.SOperator</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SOperator(bsd :: SBasis[, bsf :: SBasis], terms :: STerms ; red_q :: Int64, sym_q :: Int64, num_th :: Int64, disp_std :: Bool) :: SOperator</code></pre><p>generates an operator object from a series of terms. </p><p><strong>Arguments</strong></p><ul><li><code>bsd :: SBasis</code> is the basis of the initial state.</li><li><code>bsf :: SBasis</code> is the basis of the final state. Facultative, the same as <code>bsd</code> by default. </li><li><code>terms :: STerms</code> records the terms.</li><li><code>red_q :: Int64</code> is a flag that records whether or not the conversion to a sparse martrix can be simplified : if <code>bsd</code> and <code>bsf</code> have exactly the same set of quantum numbers, and the operator fully respects the symmetries, and all the elements in <code>bsd.cffac</code> and <code>bsf.cffac</code> has the same absolute value, then <code>red_q = 1</code> ; otherwise <code>red_q = 0</code> ; Facultative, if <code>bsf</code> is not given, 1 by default, otherwise 0 by default.</li><li><code>sym_q :: Int64</code> records the symmetry of the operator : if the matrix is Hermitian, then <code>sym_q = 1</code> ; if it is symmetric, then <code>sym_q = 2</code> ; otherwise <code>sym_q = 0</code>. Facultative, if <code>bsf</code> is not given, 1 by default, otherwise 0 by default.</li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default.</li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/soperator.jl#L31-L44">source</a></section></article><p>The product of an operator on a state and the inner product of a final state, an operator and an initial state can be calculated by</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{SOperator, Vector{ComplexF64}}" href="#Base.:*-Tuple{SOperator, Vector{ComplexF64}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(op :: SOperator, st_d :: Vector{ComplexF64} ; num_th :: Int64, disp_std :: Bool) :: Vector{ComplexF64}
*(op :: SOperator, st_d :: Vector{Float64} ; num_th :: Int64, disp_std :: Bool) :: Vector{Float64}</code></pre><p>Measure the action of an operator on a state. <code>st_d</code> must be of length <code>op.bsd.dim</code>. Returns a vector of length <code>op.bsf.dim</code> that represents the final state.</p><p><strong>Facultative arguments</strong></p><ul><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default.</li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/soperator.jl#L56-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Adjoint{ComplexF64, Vector{ComplexF64}}, SOperator, Vector{ComplexF64}}" href="#Base.:*-Tuple{Adjoint{ComplexF64, Vector{ComplexF64}}, SOperator, Vector{ComplexF64}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(st_fp :: LinearAlgebra.Adjoint{ComplexF64, Vector{ComplexF64}}, op :: SOperator, st_d :: Vector{ComplexF64} ; num_th :: Int64, disp_std :: Bool) :: ComplexF64
*(st_fp :: LinearAlgebra.Adjoint{Float64, Vector{Float64}}, op :: SOperator, st_d :: Vector{Float64} ; num_th :: Int64, disp_std :: Bool) :: Float64</code></pre><p>Measuring the inner product between two states and an operator. <code>st_d</code> must be of length <code>op.bsd.dim</code> and <code>st_fp</code> must be of length <code>op.bsf.dim</code>, and <code>st_fp</code> must be an adjoint. </p><p><strong>Facultative arguments</strong></p><ul><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default.</li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/soperator.jl#L89-L99">source</a></section></article><h3 id="Sparse-Matrix"><a class="docs-heading-anchor" href="#Sparse-Matrix">Sparse Matrix</a><a id="Sparse-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Sparse-Matrix" title="Permalink"></a></h3><p>The OpMat can be generated from <code>SOperator</code> by the following methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.OpMat-Tuple{SOperator}" href="#FuzzifiED.OpMat-Tuple{SOperator}"><code>FuzzifiED.OpMat</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OpMat[{type}](op :: SOperator ; num_th :: Int64, disp_std :: Bool) :: OpMat{type}</code></pre><p>Generates the sparse matrix from the operator. The parameter <code>type</code> is either <code>Float64</code> or <code>ComplexF64</code> ; it is facultative, given by <code>ElementType</code> by default. </p><p><strong>Arguments</strong></p><ul><li><code>op :: SOperator</code> is the operator.</li><li><code>type :: DataType</code> specifies the type of the matrix. It can either be <code>ComplexF64</code> or <code>Float64</code>. Facultative, the same as <code>ElementType</code> by default</li><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default.</li><li><code>disp_std :: Bool</code>, whether or not the log shall be displayed. Facultative, <code>!SilentStd</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sopmat.jl#L42-L53">source</a></section></article><p>After the generation of sparse matrix, the diagonalisation can be condicted with FuzzifiED. </p><h3 id="Entanglement"><a class="docs-heading-anchor" href="#Entanglement">Entanglement</a><a id="Entanglement-1"></a><a class="docs-heading-anchor-permalink" href="#Entanglement" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.StateDecompMat-Tuple{Vector{&lt;:Number}, SBasis, SBasis, SBasis, Vector{&lt;:Number}, Vector{&lt;:Number}, Vector{&lt;:Number}, Vector{&lt;:Number}}" href="#FuzzifiED.StateDecompMat-Tuple{Vector{&lt;:Number}, SBasis, SBasis, SBasis, Vector{&lt;:Number}, Vector{&lt;:Number}, Vector{&lt;:Number}, Vector{&lt;:Number}}"><code>FuzzifiED.StateDecompMat</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StateDecompMat(st :: Vector{&lt;:Number}, bs0 :: SBasis, bsa :: SBasis, bsb :: SBasis, amp_ofa :: Vector{&lt;:Number}, amp_oba :: Vector{&lt;:Number}, amp_ofb :: Vector{&lt;:Number}, amp_obb :: Vector{&lt;:Number}) :: Matrix{ComplexF64}</code></pre><p>Decompose a state <span>$|œà‚ü©=v_I|I‚ü©$</span> into a direct-product basis of two subsystems <span>$|œà‚ü©=M_{JI}|I_A‚ü©|J_B‚ü©$</span></p><p><strong>Arguments</strong></p><ul><li><code>st :: Vector{&lt;:Number}</code> is the state to be decomposed into direct-product basis of two subsystems.</li><li><code>bs0 :: SBasis</code> is the total basis. </li><li><code>bsa :: SBasis</code> is the basis for the subsystem A.</li><li><code>bsb :: SBasis</code> is the basis for the subsystem B. </li><li><code>amp_ofa :: Vector{ComplexF64}</code> is a complex list of length <code>no</code> that specifies the fermionic amplitute of each orbital in the subsystem A. For a non-local basis, we decompose each electron into creation operators in two subsystems <span>$c^‚Ä†_o=a_{o,A}c^‚Ä†_{o,A}+a_{o,B}c^‚Ä†_{o,B}$</span> and this list specifies <span>$a_{o,A}$</span>. This is equivalent to <span>$‚àö{‚Ñ±_{m,A}}$</span> in <a href="https://dx.doi.org/10.1103/PhysRevB.85.125308">PRB 85, 125308 (2012)</a> with an extra phase factor. </li><li><code>amp_oba :: Vector{ComplexF64}</code> is a complex list of length <code>no</code> that specifies the bosonic amplitute of each orbital in the subsystem A. </li><li><code>amp_ofb :: Vector{ComplexF64}</code> is a complex list of length <code>no</code> that specifies the fermionic amplitute of each orbital in the subsystem B. </li><li><code>amp_obb :: Vector{ComplexF64}</code> is a complex list of length <code>no</code> that specifies the bosonic amplitute of each orbital in the subsystem B. </li></ul><p><strong>Output</strong></p><p>A complex matrix of dimension <code>bsb.dim * bsa.dim</code> that corresponds to the state in the decomposed basis <span>$|œà‚ü©=M_{JI}|I_A‚ü©|J_B‚ü©$</span>. This is equivalent to <span>$R_{ŒºŒΩ}^A/‚àöp$</span> in <a href="https://dx.doi.org/10.1103/PhysRevB.85.125308">PRB 85, 125308 (2012)</a>. After calculating all the sectors, the reduced density matrix will be <span>$œÅ_B=‚äïùêåùêå^‚Ä†$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sentangle.jl#L4-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.GetEntSpec-Tuple{Vector{&lt;:Number}, SBasis, Vector{Vector{Vector{Int64}}}, Union{Vector{Vector{Vector{ComplexF64}}}, Vector{Vector{Vector{Float64}}}, Vector{Vector{Vector{Int64}}}}}" href="#FuzzifiED.GetEntSpec-Tuple{Vector{&lt;:Number}, SBasis, Vector{Vector{Vector{Int64}}}, Union{Vector{Vector{Vector{ComplexF64}}}, Vector{Vector{Vector{Float64}}}, Vector{Vector{Vector{Int64}}}}}"><code>FuzzifiED.GetEntSpec</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetEntSpec(st :: Vector{&lt;:Number}, bs0 :: SBasis, secd_lst :: Vector{Vector{Vector{Int64}}}, secf_lst :: Vector{Vector{Vector{&lt;:Number}}} ; qnd_a :: Vector{SQNDiag}, qnd_b :: Vector{SQNDiag} = qnd_a, qnf_a :: Vector{SQNOffd}, qnf_b :: Vector{SQNOffd} = qnf_a, amp_oa :: Vector{&lt;:Number}, amp_ob :: Vector{&lt;:Number} = sqrt.(1 .- abs.(amp_oa .^ 2))) :: Dict{@NamedTuple{secd_a, secf_a, secd_b, secf_b}, Vector{Float64}}</code></pre><p><strong>Arguments</strong></p><ul><li><code>st :: Vector{&lt;:Number}</code> is the state to be decomposed into direct-product basis of two subsystems.</li><li><code>bs0 :: SBasis</code> is the total basis. </li><li><code>secd_lst :: Vector{Vector{Vector{Int64}}}</code> gives the list of QNDiag sectors of subsystems to be calculated. Each of its elements is a two element vector ; the first specifies the sector for subsystem A, and the second specifies the sector for subsystem B. </li><li><code>secf_lst :: Vector{Vector{Vector{ComplexF64}}}</code> gives the list of QNOffd sectors of subsystems to be calculated. Each of its elements is a two element vector ; the first specifies the sector for subsystem A, and the second specifies the sector for subsystem B. </li><li><code>qnd_a :: Vector{SQNDiag}, qnd_b :: Vector{SQNDiag} = qnd_a, qnf_a :: Vector{QNOffd}, qnf_b :: Vector{QNOffd}</code> specifies the diagonal and off-diagonal quantum numbers of the subsystems A and B. <code>qnd_b</code> and <code>qnf_b</code> are facultative and the same as <code>qnd_a</code> and <code>qnf_a</code> by default. </li><li><code>amp_oa :: Vector{ComplexF64}</code> and <code>amp_ob :: Vector{ComplexF64}</code> are complex lists of length <code>no</code> that specify the amplitute of each orbital in the subsystems A and B. For a non-local basis, we decompose each electron into creation operators in two subsystems <span>$c^‚Ä†_o=a_{o,A}c^‚Ä†_{o,A}+a_{o,B}c^‚Ä†_{o,B}$</span> and this list specifies <span>$a_{o,A}$</span>. This is equivalent to <span>$‚àö{‚Ñ±_{m,A}}$</span> in <a href="https://dx.doi.org/10.1103/PhysRevB.85.125308">PRB 85, 125308 (2012)</a> with an extra phase factor. </li></ul><p><strong>Output</strong></p><p>A dictionary whose keys are named tuples that specify the sector containing entries <code>secd_a</code>, <code>secf_a</code>, <code>secd_b</code>, <code>secf_b</code> and values are lists of eigenvalues of the density matrix in those sectors. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/sentangle.jl#L39-L54">source</a></section></article><h3 id="Transformation"><a class="docs-heading-anchor" href="#Transformation">Transformation</a><a id="Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.STransf" href="#FuzzifiED.Fuzzifino.STransf"><code>FuzzifiED.Fuzzifino.STransf</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">STransf</code></pre><p>The mutable type <code>STransf</code> records a transformation in the same form as a <a href="#FuzzifiED.Fuzzifino.SQNOffd">SQNOffd</a></p><p class="math-container">\[ùíµ:\ c_o‚Ü¶ Œ±_o^* c^{(p_o)}_{œÄ_o},‚ÄÉ c_o^‚Ä†‚Ü¶ Œ±_o c^{(1-p_o)}_{œÄ_o}\]</p><p>together with information about its symmetry and the basis of the state it acts on and the basis of the resulting state.</p><p><strong>Fields</strong></p><ul><li><code>bsd :: SBasis</code> is the basis of the initial state.</li><li><code>bsf :: SBasis</code> is the basis of the final state.</li><li><code>permf :: Vector{Int64}</code>, permb :: Vector{Int64}<code>,</code>phf :: Vector{Int64}<code>and</code>facf :: Vector{ComplexF64}<code>,</code>facb :: Vector{ComplexF64}` records the transformation in the same form as a <a href="#FuzzifiED.Fuzzifino.SQNOffd">SQNOffd</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/stransf.jl#L4-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.STransf-Tuple{SBasis, SBasis, SQNOffd}" href="#FuzzifiED.Fuzzifino.STransf-Tuple{SBasis, SBasis, SQNOffd}"><code>FuzzifiED.Fuzzifino.STransf</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">STransf(bsd :: SBasis, bsf :: SBasis, qnf :: SQNOffd)</code></pre><p>generates a transformation object from a SQNOffd. </p><p><strong>Arguments</strong></p><ul><li><code>bsd :: SBasis</code> is the basis of the initial state.</li><li><code>bsf :: SBasis</code> is the basis of the final state. Facultative, the same as <code>bsd</code> by default. </li><li><code>qnf :: SQNOffd</code> records the transformation ; </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/stransf.jl#L29-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{STransf, Vector{ComplexF64}}" href="#Base.:*-Tuple{STransf, Vector{ComplexF64}}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(trs :: STransf, st_d :: Vector{ComplexF64} ; num_th = NumThreads) :: Vector{ComplexF64}
*(trs :: STransf, st_d :: Vector{Float64} ; num_th = NumThreads) :: Vector{Float64}</code></pre><p>Act a transformation on a state. <code>st_d</code> must be of length <code>trs.bsd.dim</code>. Returns a vector of length <code>trs.bsf.dim</code> that represents the final state.</p><p><strong>Facultative arguments</strong></p><ul><li><code>num_th :: Int64</code>, the number of threads. Facultative, <code>NumThreads</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/core/stransf.jl#L45-L54">source</a></section></article><h2 id="Models"><a class="docs-heading-anchor" href="#Models">Models</a><a id="Models-1"></a><a class="docs-heading-anchor-permalink" href="#Models" title="Permalink"></a></h2><p>Several quantum numbers and operator terms for the pure bosonic models are built-in.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetNeSQNDiag" href="#FuzzifiED.Fuzzifino.GetNeSQNDiag"><code>FuzzifiED.Fuzzifino.GetNeSQNDiag</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetNeSQNDiag(nof :: Int64, nob :: Int64) :: SQNDiag</code></pre><p>Return the SQNDiag of the number of particles, implemented as </p><pre><code class="language-julia hljs">SQNDiag(&quot;Ne&quot;, fill(1, nof), fill(1, nob))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_sqn.jl#L15-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonLz2SQNDiag" href="#FuzzifiED.Fuzzifino.GetBosonLz2SQNDiag"><code>FuzzifiED.Fuzzifino.GetBosonLz2SQNDiag</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonLz2SQNDiag(nof :: Int64, nm :: Int64, nf :: Int64) :: SQNDiag</code></pre><p>Return the SQNDiag of twice the angular momentum <span>$2L_z$</span> for pure bosons, implemented as </p><pre><code class="language-julia hljs">SQNDiag(&quot;Lz&quot;, fill(0, nof), collect(0 : nm * nf - 1) .√∑ nf .* 2 .- (nm - 1))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_sqn.jl#L26-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonFlavSQNDiag" href="#FuzzifiED.Fuzzifino.GetBosonFlavSQNDiag"><code>FuzzifiED.Fuzzifino.GetBosonFlavSQNDiag</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonFlavSQNDiag(nof :: Int64, nm :: Int64, nf :: Int64, qf :: Dict{Int64, Int64}[, id :: Int64 = 1, modul :: Int64 = 1]) :: QNDiag 
GetBosonFlavSQNDiag(nof :: Int64, nm :: Int64, nf :: Int64, qf :: Vector{Int64}[, id :: Int64 = 1, modul :: Int64 = 1]) :: QNDiag</code></pre><p>Return the QNDiag of linear combination of number of particles in each flavour for pure bosons, </p><p class="math-container">\[    Q = ‚àë_{f}q_fn_f\]</p><p>the factor <span>$q_f$</span> can either be given by a length-<span>$N_f$</span> vector or a dictionary containing non-zero terms. <em>E.g.</em>, for <span>$Q=n_{f=1}-n_{f=3}$</span> in a 4-flavour system, <code>qf = [1, 0, -1, 0]</code> or <code>qf = Dict(1 =&gt; 1, 3 =&gt; -3)</code>. <code>id</code> is an index to be put in the name to distinguish. For <code>qf</code> given as vector, the function is implemented as </p><pre><code class="language-julia hljs">SQNDiag(&quot;Sz$id&quot;, fill(0, nof), qf[collect(0 : nm * nf - 1) .% nf .+ 1], modul)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_sqn.jl#L36-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonFlavPermSQNOffd" href="#FuzzifiED.Fuzzifino.GetBosonFlavPermSQNOffd"><code>FuzzifiED.Fuzzifino.GetBosonFlavPermSQNOffd</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonFlavPermSQNOffd(nof :: Int64, nm :: Int64, nf :: Int64, permf[, fac][, cyc :: Int64])</code></pre><p>Return the flavour permutaiton transformation for pure bosons</p><p class="math-container">\[    ùíµ: b^‚Ä†_{mf}‚Ü¶Œ±_fb^‚Ä†_{mœÄ_f}\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> and <code>nf :: Int64</code> are the number of orbitals and the flavours.</li><li><code>permf :: Dict{Int64, Int64}</code>, <code>permf :: Vector{Vector{Int64}}</code> or <code>Vector{Int64}</code> gives the flavour permutation <span>$œÄ_f$</span>. It is either a vector of the cycles, a vector of the target flavours, or a dictionary of the changed elements. <em>E.g.</em>, a permutation <span>$1‚Ü¶4,2‚Ü¶5,3‚Ü¶3,4‚Ü¶1,5‚Ü¶6,6‚Ü¶2$</span> can be expressed as <code>[4,5,3,1,6,2]</code>, <code>[[1,4],[2,5,6]]</code> or <code>Dict(1=&gt;4,2=&gt;5,4=&gt;1,5=&gt;6,6=&gt;2)</code>. Facultative, identity by default. </li><li><code>fac :: Dict{Int64, &lt;: Number}</code> or <code>Vector{&lt;: Number}</code> gives the factor <span>$Œ±_f$</span>. It is either a vector of all vectors, or a dictionary of all non-unity elements. Facultative, all unity by default. </li><li><code>cyc :: Int64</code> is the period of the permutation. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_sqn.jl#L52-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonRotySQNOffd" href="#FuzzifiED.Fuzzifino.GetBosonRotySQNOffd"><code>FuzzifiED.Fuzzifino.GetBosonRotySQNOffd</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonRotySQNOffd(nof :: Int64, nm :: Int64, nf :: Int64)</code></pre><p>Return the <span>$œÄ$</span>-rotation with respect to the <span>$y$</span>-axis for pure bosons. </p><p class="math-container">\[    ‚Ñõ_y: b^‚Ä†_{mf}‚Ü¶(-)^{m+s}b^‚Ä†_{-mf}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_sqn.jl#L85-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonDenIntSTerms" href="#FuzzifiED.Fuzzifino.GetBosonDenIntSTerms"><code>FuzzifiED.Fuzzifino.GetBosonDenIntSTerms</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonDenIntSTerms(nm :: Int64, nf :: Int64[, ps_pot :: Vector{&lt;:Number}][, mat_a :: Matrix{&lt;:Number}[, mat_b :: Matrix{&lt;:Number}]]) :: Terms</code></pre><p>Return the normal-ordered density-density term in the Hamiltonian for bosons</p><p class="math-container">\[‚àë_{\{m_i,f_i\}}U_{m_1m_2m_3m_4}M^A_{f_1f_4}M^B_{f_2f_3}b^{‚Ä†}_{m_1f_1}b^{‚Ä†}_{m_2f_2}b_{m_3f_3}b_{m_4f_4}.\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>ps_pot :: Vector{&lt;:Number}</code> is a list of numbers specifying the pseudopotentials for the interacting matrix <span>$U_{m_1m_2m_3m_4}$</span>. Facultative, <code>[1.0]</code> by default. </li><li><code>mat_a :: Matrix{&lt;:Number}</code> is a <code>nf</code>√ó<code>nf</code> matrix specifying <span>$M^A_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>mat_b :: Matrix{&lt;:Number}</code> is a <code>nf</code>√ó<code>nf</code> matrix specifying <span>$M^B_{ff&#39;}$</span>. Facultative, the Hermitian conjugate of <code>mat_a</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_opsterms.jl#L4-L19">source</a></section><section><div><pre><code class="language-julia hljs">GetBosonDenIntSTerms(nm :: Int64, nf :: Int64, ps_pot :: Vector{&lt;:Number}, mat_a :: Vector{&lt;:AbstractMatrix{&lt;:Number}}[, mat_b :: Vector{&lt;:AbstractMatrix{&lt;:Number}}]) :: Terms</code></pre><p>Return the sum of a series of normal-ordered density-density term in the Hamiltonian for bosons</p><p class="math-container">\[‚àë_{\{m_i,f_i,Œ±\}}U_{m_1m_2m_3m_4}(M^A_{Œ±})_{f_1f_4}(M^B_{Œ±})_{f_2f_3}b^{‚Ä†}_{m_1f_1}b^{‚Ä†}_{m_2f_2}b_{m_3f_3}b_{m_4f_4}.\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>ps_pot :: Vector{&lt;:Number}</code> is a list of numbers specifying the pseudopotentials for the interacting matrix <span>$U_{m_1m_2m_3m_4}$</span>. Facultative, <code>[1.0]</code> by default.</li><li><code>mat_a :: Vector{&lt;:AbstractMatrix{&lt;:Number}}</code> is a vector of <code>nf</code>√ó<code>nf</code> matrix specifying <span>$(M^A_{Œ±})_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>mat_b :: Vector{&lt;:AbstractMatrix{&lt;:Number}}</code> is a vector of <code>nf</code>√ó<code>nf</code> matrix specifying <span>$(M^B_{Œ±})_{ff&#39;}$</span>. Facultative, the Hermitian conjugate of <code>mat_a</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_opsterms.jl#L51-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonPairIntSTerms" href="#FuzzifiED.Fuzzifino.GetBosonPairIntSTerms"><code>FuzzifiED.Fuzzifino.GetBosonPairIntSTerms</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonPairIntSTerms(nm :: Int64, nf :: Int64, ps_pot :: Vector{&lt;:Number}, mat_a :: Matrix{&lt;:Number}[, mat_b :: Matrix{&lt;:Number}]) :: Terms</code></pre><p>Return the normal-ordered pair-pair interaction term in the Hamiltonian for bosons</p><p class="math-container">\[‚àë_{\{m_i,f_i\}}U_{m_1m_2m_3m_4}M^A_{f_1f_2}M^B_{f_3f_4}b^{‚Ä†}_{m_1f_1}b^{‚Ä†}_{m_2f_2}b_{m_3f_3}b_{m_4f_4}.\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>ps_pot :: Vector{&lt;:Number}</code> is a list of numbers specifying the pseudopotentials for the interacting matrix <span>$U_{m_1m_2m_3m_4}$</span>. </li><li><code>mat_a :: Matrix{&lt;:Number}</code> is a <code>nf</code>√ó<code>nf</code> matrix specifying <span>$M^A_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>mat_b :: Matrix{&lt;:Number}</code> is a <code>nf</code>√ó<code>nf</code> matrix specifying <span>$M^B_{ff&#39;}$</span>. Facultative, the Hermitian conjugate of <code>mat_a</code> by default. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_opsterms.jl#L73-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonPolSTerms" href="#FuzzifiED.Fuzzifino.GetBosonPolSTerms"><code>FuzzifiED.Fuzzifino.GetBosonPolSTerms</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonPolSTerms(nm :: Int64, nf :: Int64[, mat :: Matrix{&lt;:Number}][ ; fld_m :: Vector{&lt;:Number}]) :: STerms</code></pre><p>Return the polarisation term in the Hamiltonian for bosons</p><p class="math-container">\[‚àë_{mff&#39;}c^{‚Ä†}_{mf}M_{ff&#39;}c_{mf&#39;}.\]</p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours. </li><li><code>mat :: Matrix{&lt;:Number}</code> is a <code>nf</code>√ó<code>nf</code> matrix specifying <span>$M_{ff&#39;}$</span>. Facultative, <span>$I_{N_f}$</span> by default. </li><li><code>fld_m :: Vector{&lt;:Number}</code> gives an orbital dependent polarisation</li></ul><p class="math-container">\[‚àë_{mff&#39;}h_mc^{‚Ä†}_{mf}M_{ff&#39;}c_{mf&#39;}\]</p><p>Facultative. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_opsterms.jl#L120-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonLpLzSTerms" href="#FuzzifiED.Fuzzifino.GetBosonLpLzSTerms"><code>FuzzifiED.Fuzzifino.GetBosonLpLzSTerms</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonLpLzSTerms(nm :: Int64, nf :: Int64) :: Tuple{Terms, Terms}</code></pre><p>Return the a pair of terms containing <span>$L^z$</span> and <span>$L^+$</span> for bosons. </p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of bosonic orbitals.</li><li><code>nf :: Int64</code> is the number of bosonic flavours.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_opsterms.jl#L192-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetL2STerms-Tuple{Tuple{Vector{STerm}, Vector{STerm}}}" href="#FuzzifiED.Fuzzifino.GetL2STerms-Tuple{Tuple{Vector{STerm}, Vector{STerm}}}"><code>FuzzifiED.Fuzzifino.GetL2STerms</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetL2Terms(tms_lzlp :: Tuple{STerms, STerms}) :: STerms</code></pre><p>Return the terms for the total angular momentum from a tuple of terms containing <span>$L^z$</span> and <span>$L^+$</span>, implemented as </p><pre><code class="language-julia hljs">tms_lz, tms_lp = tms_lzlp 
return SimplifyTerms(tms_lz * tms_lz - tms_lz + tms_lp * tms_lp&#39;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_opsterms.jl#L216-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.GetBosonC2STerms" href="#FuzzifiED.Fuzzifino.GetBosonC2STerms"><code>FuzzifiED.Fuzzifino.GetBosonC2STerms</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetBosonC2STerms(nm :: Int64, nf :: Int64, mat_gen :: Vector{Matrix{&lt;:Number}}[, mat_tr :: Vector{Matrix{&lt;:Number}}]) :: STerms</code></pre><p>Return the terms for the quadratic Casimir of the flavour symmetry for bosons.</p><p class="math-container">\[    C_2=‚àë_{imm&#39;}\frac{(b^‚Ä†_{mf_1}G_{i,f_1f_2}b_{mf_2})(b^‚Ä†_{m&#39;f_3}G^‚Ä†_{i,f_3f_4}b_{m&#39;f_4})}{2\operatorname{tr}G_i^‚Ä†G_i}-‚àë_{imm&#39;}\frac{(b^‚Ä†_{mf_1}T_{i,f_1f_2}b_{mf_2})(b^‚Ä†_{m&#39;f_3}T^‚Ä†_{i,f_3f_4}b_{m&#39;f_4})}{2\operatorname{tr}T_i^‚Ä†T_i}\]</p><p>where <span>$G_i$</span> are the generator matrices, and <span>$T_i$</span> are the trace matrices. </p><p><strong>Arguments</strong></p><ul><li><code>nm :: Int64</code> is the number of orbitals.</li><li><code>nf :: Int64</code> is the number of flavours.</li><li><code>mat_gen :: Vector{Matrix{Number}}</code> is a list of the matrices that gives the generators. It will automatically be normalised such that its square traces to <span>$1/2$</span>. </li><li><code>mat_tr :: Vector{Matrix{Number}}</code> is a list of trace matrices that will be normalised automatically and substracted. Facultative.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/boson_opsterms.jl#L229-L243">source</a></section></article><p>The types <code>SSphereObs</code> and <code>SAngModes</code> are similarly defined as their fermionic counterparts</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SSphereObs" href="#FuzzifiED.Fuzzifino.SSphereObs"><code>FuzzifiED.Fuzzifino.SSphereObs</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SSphereObs</code></pre><p>The mutable type <code>SSphereObs</code> stores the information of a local observable (or local operator) <span>$ùí™$</span> that can be decomposed into angular components.</p><p class="math-container">\[    ùí™(\Omega)=‚àë_{lm}ùí™_{lm}Y^{(s)}_{lm}\]</p><p><strong>Fields</strong></p><ul><li><code>s2 :: Int64</code> is twice the spin <span>$2s$</span> of the observable.</li><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the observable. </li><li><code>get_comp :: Function</code> is a function <code>get_comp(l2 :: Int64, m2 :: Int64) :: STerms</code> that sends the component specified by a tuple of integers <span>$(2l,2m)$</span> where <span>$|s|\leq l\leq l_{\max}, -l\leq m\leq l$</span> to a list of terms that specifies the expression of the component. </li><li><code>stored_q :: Bool</code> is a boolean that specifies whether or not each component of the observable is stored.</li><li><code>comps :: Dict{Tuple{Int64, Int64}, STerms}</code> stores each component of the observable in the format of a dictionary whose keys are the tuples of integers <span>$(2l,2m)$</span> and values are the lists of terms that specifies the expression of the component. </li></ul><p><strong>Methods</strong></p><p>The methods for this type is similarly defined as in SphereObs.</p><pre><code class="language-julia hljs">SSphereObs(s2 :: Int64, l2m :: Int64, get_comp :: Function) :: SSphereObs
SSphereObs(s2 :: Int64, l2m :: Int64, comps :: Dict{Tuple{Int64, Int64}, STerms}) :: SSphereObs
StoreComps(obs :: SSphereObs) :: SSphereObs
*(fac :: Number, obs :: SSphereObs) :: SSphereObs
+(obs1 :: SSphereObs, obs2 :: SSphereObs) :: SSphereObs
adjoint(obs :: SSphereObs) :: SSphereObs
*(obs1 :: SSphereObs, obs2 :: SSphereObs) :: SSphereObs
PadSSphereObs(obs :: SSphereObs, nofl :: Int64, nobl :: Int64) :: SSphereObs
Laplacian(obs :: SSphereObs[ ; norm_r2 :: Float64]) :: SSphereObs
GetIntegral(obs :: SSphereObs[ ; norm_r2 :: Float64]) :: STerms
GetComponent(obs :: SSphereObs, l :: Number, m :: Number) :: STerms
FilterComponent(obs :: SSphereObs, flt) :: AngModes 
GetPointValue(obs :: SSphereObs, Œ∏ :: Float64, œï :: Float64) :: STerms
GetFermionSObs(nm :: Int64, nf :: Int64, f :: Int64[ ; norm_r2 :: Float64]) :: SSphereObs
GetBosonSObs(nm :: Int64, nf :: Int64, f :: Int64[ ; norm_r2 :: Float64]) :: SSphereObs
GetFerDensitySObs(nm :: Int64, nf :: Int64[, mat :: Matrix{&lt;:Number}][ ; norm_r2 :: Float64]) :: SSphereObs
GetBosDensitySObs(nm :: Int64, nf :: Int64[, mat :: Matrix{&lt;:Number}][ ; norm_r2 :: Float64]) :: SSphereObs</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/ssphere_obs.jl#L5-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FuzzifiED.Fuzzifino.SAngModes" href="#FuzzifiED.Fuzzifino.SAngModes"><code>FuzzifiED.Fuzzifino.SAngModes</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SAngModes</code></pre><p>The mutable type <code>SAngModes</code> stores angular momentum components of an operator on the sphere <span>$Œ¶_{lm}$</span> and superposes in the rule of Clebsch-Gordan coefficients. The usage is similar to the spherical observables, except that SphereObs superposes in the rule of spherical harmonics and has the notion of locality</p><p><strong>Fields</strong></p><ul><li><code>l2m :: Int64</code> is twice the maximal angular momentum <span>$2l_{\max}$</span> of the components of the modes object. </li><li><code>get_comp :: Function</code> is a function <code>get_comp(l2 :: Int64, m2 :: Int64) :: STerms</code> that sends the component specified by a tuple of integers <span>$(2l,2m)$</span> where <span>$|s|\leq l\leq l_{\max}, -l\leq m\leq l$</span> to a list of terms that specifies the expression of the component. </li><li><code>stored_q :: Bool</code> is a boolean that specifies whether or not each component of the modes object is stored.</li><li><code>comps :: Dict{Tuple{Int64, Int64}, STerms}</code> stores each component of the modes object in the format of a dictionary whose keys are the tuples of integers <span>$(2l,2m)$</span> and values are the lists of terms that specifies the expression of the component. </li></ul><p><strong>Methods</strong></p><p>The methods for this type is similarly defined as in AngModes.</p><pre><code class="language-julia hljs">SAngModes(l2m :: Int64, get_comp :: Function) :: SAngModes
SAngModes(l2m :: Int64, cmps :: Dict{Tuple{Int64, Int64}, STerms}) :: SAngModes
StoreComps!(amd :: SAngModes)
StoreComps(amd :: SAngModes) :: SAngModes
*(fac :: Number, amd :: SAngModes) :: SAngModes
+(amd1 :: SAngModes, amd2 :: SAngModes) :: SAngModes
adjoint(amd :: SAngModes) :: SAngModes
*(amd1 :: SAngModes, amd2 :: SAngModes) :: SAngModes
PadSAngModes(amd :: SAngModes, nofl :: Int64, nobl :: Int64) :: SAngModes
GetComponent(amd :: SAngModes, l :: Number, m :: Number) :: STerms
ContractMod(amd1 :: SAngModes, amd2 :: amd2, comps :: Dict) :: STerms
ContractMod(amd1 :: SAngModes, amd2 :: SAngModes, l0 :: Number) :: STerms
FilterComponent(amd :: SAngModes, flt) :: SAngModes 
FilterL2(amd :: SAngModes, l :: Number) :: SAngModes 
GetFermionSMod(nm :: Int64, nf :: Int64, f :: Int64) :: SAngModes
GetBosonSMod(nm :: Int64, nf :: Int64, f :: Int64) :: SAngModes
GetFerPairingSMod(nm :: Int64, nf :: Int64, mat :: Matrix{&lt;:Number}) :: SAngModes
GetBosPairingSMod(nm :: Int64, nf :: Int64, mat :: Matrix{&lt;:Number}) :: SAngModes
GetFerDensitySMod(nm :: Int64, nf :: Int64, mat :: Matrix{&lt;:Number}) :: SAngModes
GetBosDensitySMod(nm :: Int64, nf :: Int64, mat :: Matrix{&lt;:Number}) :: SAngModes</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/cd9dbe9fc1097baacb5c2ec78097b40a58534ac4/src/fuzzifino/model/sang_modes.jl#L4-L40">source</a></section></article><h2 id="Related-Examples"><a class="docs-heading-anchor" href="#Related-Examples">Related Examples</a><a id="Related-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Related-Examples" title="Permalink"></a></h2><ul><li><a href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/main/examples/ising_frac_boson.jl"><code>ising_frac_boson.jl</code></a> calculates the spectrum of 3d Ising model on the fuzzy sphere for bosons at fractional filling <span>$ŒΩ = 1/2$</span>. This example reproduces Figure 12a,b in <a href="../intro/#Voinea2024">Voinea 2024</a>.</li><li><a href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/main/examples/su2_1_scal_spectrum.jl"><code>su2_1_scal_spectrum.jl</code></a> calculates the spectrum of the <span>$\mathrm{SU}(2)_1$</span> coupled to a complex scalar Chern-Simons matter CFT on the fuzzy sphere. This example reproduces Figs. 2d and 3 in <a href="../intro/#Zhou2025Jul">Zhou 2025Jul</a>.</li><li><a href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/main/examples/free_majorana_spectrum.jl"><code>free_majorana_spectrum.jl</code></a> calculates the spectrum of free Majorana fermion. This example reproduces Figure 5 in <a href="../intro/#Zhou2025Sep">Zhou 2025Sep</a>. </li><li><a href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/main/examples/free_majorana_correlator.jl"><code>free_majorana_correlator.jl</code></a> calculates the 2-pt correlator of free Majorana fermion. This example reproduces Figure 7 in <a href="../intro/#Zhou2025Sep">Zhou 2025Sep</a>.</li><li><a href="https://github.com/FuzzifiED/FuzzifiED.jl/blob/main/examples/bpf_220_spectrum.jl"><code>bpf_220_spectrum.jl</code></a> calculates the spectrum of the transition between bosonic Pfaffian and Halperin 220 described by gauged Majorana fermion CFT # This example reproduces Figure 4a in <a href="../intro/#Voinea2025">Voinea 2025</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../extension/">¬´ Other Extensions</a><a class="docs-footer-nextpage" href="../manifolds/">Fuzzy Manifolds ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>. Copyright (c) 2025 Zheng Zhou (Âë®Ê≠£) and contributors.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 28 November 2025 11:37">Friday 28 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
